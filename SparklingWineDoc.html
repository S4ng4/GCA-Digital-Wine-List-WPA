<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0, viewport-fit=cover">
<meta name="description" content="Complete technical guide to Italian sparkling wine production methods: technical differences, organoleptic characteristics and styles">
<title>Technical Guide - Italian Sparkling Wines: Production Methods</title>

<!-- Font Awesome (HTTPS CDN) -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" integrity="sha512-iecdLmaskl7CVkqkXNQ/ZH/XLlvWZOJyj7Yy7tcenmpD1ypASozpmT/E0iPtmFIB46ZmdtAc9eNBvH0H/ZpiBw==" crossorigin="anonymous" referrerpolicy="no-referrer">

<!-- Google Fonts (HTTPS) -->
<link href="https://fonts.googleapis.com/css2?family=Cinzel:wght@400;600;700&family=Cormorant:wght@300;400;500;600&family=Inter:wght@300;400;500;600&display=swap" rel="stylesheet">

<!-- Chart.js for data visualization -->
<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>

<!-- Custom CSS -->
<style>
:root {
  --bg: #0A0A0A;
  --card: #1A1A1A;
  --text: #F5F5F0;
  --muted: rgba(245, 245, 240, 0.7);
  --accent: #7a1f2b;
  --gold: #D4AF37;
  --success: #2e7d32;
  --info: #0288d1;
  --warning: #ed6c02;
  --charmat: #0288d1;
  --ancestrale: #ed6c02;
  --classico: #2e7d32;
}

* { 
  box-sizing: border-box;
  margin: 0;
  padding: 0;
}

html {
  overflow-x: hidden;
  width: 100%;
  max-width: 100vw;
}

body {
  font-family: 'Cormorant', serif;
  background: var(--bg);
  color: var(--text);
  line-height: 1.7;
  min-height: 100vh;
  overflow-x: hidden;
  width: 100%;
  max-width: 100vw;
  padding-top: 70px;
  position: relative;
}

/* Improved fixed header */
.doc-header {
  background: rgba(10, 10, 10, 0.98);
  backdrop-filter: blur(20px);
  border-bottom: 1px solid rgba(212, 175, 55, 0.3);
  padding: 1rem 1rem;
  position: fixed;
  top: 0;
  left: 0;
  right: 0;
  width: 100%;
  max-width: 100vw;
  z-index: 1000;
  display: flex;
  justify-content: space-between;
  align-items: center;
  box-shadow: 0 4px 30px rgba(0, 0, 0, 0.5);
  overflow-x: hidden;
}

.header-nav {
  display: flex;
  gap: 0.75rem;
  align-items: center;
  flex-wrap: wrap;
  overflow-x: auto;
  -webkit-overflow-scrolling: touch;
}

.nav-link {
  color: var(--muted);
  text-decoration: none;
  font-family: 'Cormorant', serif;
  font-size: 1.1rem;
  padding: 0.5rem 1rem;
  border-radius: 6px;
  transition: all 0.3s ease;
  position: relative;
}

.nav-link:hover {
  color: var(--gold);
  background: rgba(212, 175, 55, 0.1);
}

.nav-link.active {
  color: var(--gold);
  border-bottom: 2px solid var(--gold);
}

.btn-back {
  background: rgba(212, 175, 55, 0.1);
  border: 1px solid var(--gold);
  color: var(--gold);
  padding: 0.75rem 1.5rem;
  border-radius: 8px;
  text-decoration: none;
  display: inline-flex;
  align-items: center;
  gap: 0.5rem;
  font-family: 'Cormorant', serif;
  transition: all 0.3s ease;
}

.btn-back:hover {
  background: rgba(212, 175, 55, 0.2);
  transform: translateX(-3px);
  box-shadow: 0 5px 15px rgba(212, 175, 55, 0.2);
}

/* Main Container */
.main-container {
  width: 100%;
  max-width: 100vw;
  overflow-x: hidden;
  position: relative;
}

/* Hero Section */
.hero {
  text-align: center;
  padding: 4rem 1rem 3rem;
  background: linear-gradient(135deg, rgba(26, 26, 26, 0.9), rgba(10, 10, 10, 0.95));
  border-bottom: 1px solid rgba(212, 175, 55, 0.2);
  margin-bottom: 3rem;
  width: 100%;
  max-width: 100%;
}

.hero h1 {
  font-family: 'Cinzel', serif;
  font-size: clamp(2rem, 5vw, 3.5rem);
  background: linear-gradient(135deg, var(--gold), #F4CF67);
  -webkit-background-clip: text;
  background-clip: text;
  -webkit-text-fill-color: transparent;
  margin-bottom: 1rem;
  letter-spacing: 1px;
  word-wrap: break-word;
  overflow-wrap: break-word;
}

.hero-subtitle {
  font-size: 1.3rem;
  color: var(--muted);
  max-width: 800px;
  margin: 0 auto;
  line-height: 1.6;
  padding: 0 1rem;
  width: 100%;
  box-sizing: border-box;
}

/* Navigation Cards */
.method-nav {
  display: grid;
  grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
  gap: 1.5rem;
  padding: 0 1rem;
  margin-bottom: 4rem;
  width: 100%;
  max-width: 100%;
}

.method-card {
  background: linear-gradient(145deg, rgba(26, 26, 26, 0.95), rgba(10, 10, 10, 0.98));
  border-radius: 15px;
  padding: 2rem;
  text-align: center;
  border: 2px solid transparent;
  transition: all 0.4s ease;
  cursor: pointer;
  position: relative;
  overflow: hidden;
}

.method-card.charmat {
  border-color: var(--charmat);
}

.method-card.ancestrale {
  border-color: var(--ancestrale);
}

.method-card.classico {
  border-color: var(--classico);
}

.method-card:hover {
  transform: translateY(-10px);
  box-shadow: 0 20px 40px rgba(0, 0, 0, 0.4);
}

.method-icon {
  font-size: 3rem;
  margin-bottom: 1rem;
  color: var(--gold);
}

.method-card h3 {
  font-family: 'Cinzel', serif;
  font-size: 1.8rem;
  margin-bottom: 1rem;
  color: var(--gold);
}

/* HORIZONTAL Timeline Process */
.horizontal-process {
  padding: 3rem 1rem;
  margin: 4rem 0;
  width: 100%;
  max-width: 100%;
  overflow-x: hidden;
}

.process-container {
  display: flex;
  justify-content: space-between;
  align-items: center;
  position: relative;
  margin-top: 3rem;
  width: 100%;
  max-width: 100%;
  overflow-x: hidden;
}

.process-container::before {
  content: '';
  position: absolute;
  top: 50%;
  left: 5%;
  right: 5%;
  height: 2px;
  background: linear-gradient(90deg, 
    var(--charmat) 0%, 
    var(--charmat) 33%, 
    var(--ancestrale) 33%, 
    var(--ancestrale) 66%, 
    var(--classico) 66%, 
    var(--classico) 100%);
  z-index: 1;
}

.method-column {
  flex: 1;
  display: flex;
  flex-direction: column;
  align-items: center;
  position: relative;
  z-index: 2;
}

.method-title {
  font-family: 'Cinzel', serif;
  font-size: 1.5rem;
  color: var(--gold);
  margin-bottom: 2rem;
  text-align: center;
  padding: 0.5rem 1rem;
  background: rgba(10, 10, 10, 0.9);
  border-radius: 8px;
}

.process-steps {
  display: flex;
  flex-direction: column;
  gap: 1.5rem;
  width: 100%;
  max-width: 100%;
}

.process-step {
  background: var(--card);
  border: 2px solid;
  border-radius: 10px;
  padding: 1.2rem;
  text-align: center;
  font-family: 'Cormorant', serif;
  transition: all 0.3s ease;
  position: relative;
}

.charmat-steps .process-step {
  border-color: var(--charmat);
}

.ancestrale-steps .process-step {
  border-color: var(--ancestrale);
}

.classico-steps .process-step {
  border-color: var(--classico);
}

.process-step:hover {
  transform: translateY(-5px);
  box-shadow: 0 10px 20px rgba(0, 0, 0, 0.3);
}

.step-number {
  display: block;
  font-family: 'Cinzel', serif;
  font-size: 1.2rem;
  color: var(--gold);
  margin-bottom: 0.5rem;
  font-weight: bold;
}

/* Data Visualization */
.chart-container {
  background: rgba(26, 26, 26, 0.8);
  backdrop-filter: blur(10px);
  -webkit-backdrop-filter: blur(10px);
  border-radius: 15px;
  padding: 1.5rem;
  margin: 2rem 1rem;
  max-width: calc(100% - 2rem);
  width: 100%;
  border: 1px solid rgba(212, 175, 55, 0.2);
  transition: all 0.3s ease;
  overflow-x: hidden;
}

.chart-container:hover {
  border-color: rgba(212, 175, 55, 0.4);
  box-shadow: 0 8px 32px rgba(0, 0, 0, 0.3);
}

.chart-title {
  font-family: 'Cinzel', serif;
  font-size: 1.5rem;
  color: var(--gold);
  margin-bottom: 1.5rem;
  text-align: center;
  font-weight: 600;
  letter-spacing: 0.5px;
}

.chart-wrapper {
  position: relative;
  width: 100%;
  max-width: 100%;
  height: 300px;
  margin: 0 auto;
}

.chart-wrapper canvas {
  max-width: 100% !important;
  height: 100% !important;
  width: 100% !important;
}

/* Comparison Table */
.comparison-table {
  width: 100%;
  max-width: 100%;
  border-collapse: collapse;
  margin: 3rem 0;
  background: rgba(26, 26, 26, 0.8);
  border-radius: 10px;
  overflow-x: auto;
  display: block;
  -webkit-overflow-scrolling: touch;
}

.comparison-table thead,
.comparison-table tbody,
.comparison-table tr {
  display: table;
  width: 100%;
  table-layout: fixed;
}

.comparison-table th {
  background: rgba(212, 175, 55, 0.1);
  padding: 1.5rem;
  text-align: left;
  font-family: 'Cinzel', serif;
  color: var(--gold);
  font-size: 1.2rem;
  border-bottom: 2px solid var(--gold);
}

.comparison-table td {
  padding: 1.2rem 1.5rem;
  border-bottom: 1px solid rgba(212, 175, 55, 0.1);
  font-family: 'Cormorant', serif;
}

.comparison-table tr:hover {
  background: rgba(212, 175, 55, 0.05);
}

/* Info Cards */
.info-grid {
  display: grid;
  grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
  gap: 2rem;
  padding: 2rem;
}

.info-card {
  background: linear-gradient(145deg, rgba(26, 26, 26, 0.9), rgba(10, 10, 10, 0.95));
  border-radius: 12px;
  padding: 2rem;
  border-left: 4px solid var(--gold);
  transition: transform 0.3s ease;
}

.info-card:hover {
  transform: translateY(-5px);
}

.info-card h4 {
  font-family: 'Cinzel', serif;
  color: var(--gold);
  margin-bottom: 1rem;
  font-size: 1.4rem;
}

/* Section Headers */
.section-header {
  text-align: center;
  padding: 2rem;
  margin: 2rem 0;
}

.section-header h2 {
  font-family: 'Cinzel', serif;
  font-size: 2.5rem;
  color: var(--gold);
  margin-bottom: 1rem;
  position: relative;
  display: inline-block;
}

.section-header h2::after {
  content: '';
  position: absolute;
  bottom: -10px;
  left: 50%;
  transform: translateX(-50%);
  width: 100px;
  height: 3px;
  background: linear-gradient(90deg, transparent, var(--gold), transparent);
}

/* Method Detail Sections */
.method-section {
  padding: 4rem 2rem;
  margin: 2rem 0;
  border-top: 1px solid rgba(212, 175, 55, 0.1);
  border-bottom: 1px solid rgba(212, 175, 55, 0.1);
}

.method-section.charmat {
  background: linear-gradient(135deg, rgba(2, 136, 209, 0.05), transparent);
}

.method-section.ancestrale {
  background: linear-gradient(135deg, rgba(237, 108, 2, 0.05), transparent);
}

.method-section.classico {
  background: linear-gradient(135deg, rgba(46, 125, 50, 0.05), transparent);
}

.method-detail-grid {
  display: grid;
  grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
  gap: 1.5rem;
  margin-top: 2rem;
  width: 100%;
  max-width: 100%;
}

.detail-card {
  background: rgba(26, 26, 26, 0.9);
  border-radius: 12px;
  padding: 1.5rem;
  border: 1px solid;
  transition: all 0.3s ease;
}

.detail-card.charmat {
  border-color: var(--charmat);
}

.detail-card.ancestrale {
  border-color: var(--ancestrale);
}

.detail-card.classico {
  border-color: var(--classico);
}

.detail-card:hover {
  transform: translateY(-5px);
  box-shadow: 0 15px 30px rgba(0, 0, 0, 0.3);
}

/* Method View Wines Button */
.method-view-wines-btn {
  display: inline-flex;
  align-items: center;
  gap: 0.75rem;
  padding: 1rem 2rem;
  margin: 2rem auto;
  background: linear-gradient(135deg, rgba(212, 175, 55, 0.1), rgba(212, 175, 55, 0.2));
  border: 2px solid var(--gold);
  border-radius: 10px;
  color: var(--gold);
  text-decoration: none;
  font-family: 'Cinzel', serif;
  font-size: 1.1rem;
  font-weight: 600;
  transition: all 0.3s ease;
  cursor: pointer;
  text-align: center;
  width: fit-content;
  max-width: 100%;
}

.method-view-wines-btn.charmat {
  border-color: var(--charmat);
  color: var(--charmat);
  background: linear-gradient(135deg, rgba(2, 136, 209, 0.1), rgba(2, 136, 209, 0.2));
}

.method-view-wines-btn.charmat:hover {
  background: linear-gradient(135deg, rgba(2, 136, 209, 0.2), rgba(2, 136, 209, 0.3));
  transform: translateY(-3px);
  box-shadow: 0 10px 25px rgba(2, 136, 209, 0.3);
}

.method-view-wines-btn.ancestrale {
  border-color: var(--ancestrale);
  color: var(--ancestrale);
  background: linear-gradient(135deg, rgba(237, 108, 2, 0.1), rgba(237, 108, 2, 0.2));
}

.method-view-wines-btn.ancestrale:hover {
  background: linear-gradient(135deg, rgba(237, 108, 2, 0.2), rgba(237, 108, 2, 0.3));
  transform: translateY(-3px);
  box-shadow: 0 10px 25px rgba(237, 108, 2, 0.3);
}

.method-view-wines-btn.classico {
  border-color: var(--classico);
  color: var(--classico);
  background: linear-gradient(135deg, rgba(46, 125, 50, 0.1), rgba(46, 125, 50, 0.2));
}

.method-view-wines-btn.classico:hover {
  background: linear-gradient(135deg, rgba(46, 125, 50, 0.2), rgba(46, 125, 50, 0.3));
  transform: translateY(-3px);
  box-shadow: 0 10px 25px rgba(46, 125, 50, 0.3);
}

.method-view-wines-btn:hover {
  transform: translateY(-3px);
  box-shadow: 0 10px 25px rgba(212, 175, 55, 0.3);
}

.method-view-wines-btn i {
  font-size: 1.2rem;
  transition: transform 0.3s ease;
}

.method-view-wines-btn:hover i {
  transform: translateX(5px);
}

.method-button-container {
  text-align: center;
  width: 100%;
  margin-top: 2rem;
  padding: 0 1rem;
}

/* Wines Popup Modal */
.wines-popup {
  display: none;
  position: fixed;
  top: 0;
  left: 0;
  right: 0;
  bottom: 0;
  background: rgba(0, 0, 0, 0.9);
  backdrop-filter: blur(10px);
  z-index: 10000;
  overflow-y: auto;
  padding: 2rem 1rem;
  animation: fadeIn 0.3s ease;
  align-items: center;
  justify-content: center;
}

.wines-popup[style*="display: flex"] {
  display: flex !important;
}

@keyframes fadeIn {
  from {
    opacity: 0;
  }
  to {
    opacity: 1;
  }
}

.wines-popup-container {
  background: var(--card);
  border-radius: 20px;
  max-width: 900px;
  width: 100%;
  margin: auto;
  max-height: 90vh;
  display: flex;
  flex-direction: column;
  box-shadow: 0 20px 60px rgba(0, 0, 0, 0.5);
  border: 1px solid rgba(212, 175, 55, 0.3);
  animation: slideUp 0.3s ease;
}

@keyframes slideUp {
  from {
    transform: translateY(50px);
    opacity: 0;
  }
  to {
    transform: translateY(0);
    opacity: 1;
  }
}

.wines-popup-header {
  display: flex;
  justify-content: space-between;
  align-items: center;
  padding: 2rem;
  border-bottom: 1px solid rgba(212, 175, 55, 0.2);
  position: sticky;
  top: 0;
  background: var(--card);
  border-radius: 20px 20px 0 0;
  z-index: 1;
}

.wines-popup-title {
  font-family: 'Cinzel', serif;
  font-size: 2rem;
  color: var(--gold);
  margin: 0;
}

.wines-popup-close {
  background: transparent;
  border: 2px solid var(--gold);
  color: var(--gold);
  width: 40px;
  height: 40px;
  border-radius: 50%;
  display: flex;
  align-items: center;
  justify-content: center;
  cursor: pointer;
  transition: all 0.3s ease;
  font-size: 1.2rem;
}

.wines-popup-close:hover {
  background: var(--gold);
  color: var(--bg);
  transform: rotate(90deg);
}

.wines-popup-content {
  padding: 2rem;
  overflow-y: auto;
  flex: 1;
}

.wines-popup-list {
  display: grid;
  grid-template-columns: repeat(auto-fill, minmax(280px, 1fr));
  gap: 1.5rem;
}

.wine-popup-card {
  background: rgba(26, 26, 26, 0.8);
  border: 1px solid rgba(212, 175, 55, 0.2);
  border-radius: 12px;
  padding: 1.5rem;
  cursor: pointer;
  transition: all 0.3s ease;
}

.wine-popup-card:hover {
  transform: translateY(-5px);
  border-color: var(--gold);
  box-shadow: 0 10px 30px rgba(212, 175, 55, 0.2);
  background: rgba(26, 26, 26, 0.95);
}

.wine-popup-card-content {
  display: flex;
  justify-content: space-between;
  align-items: flex-start;
  gap: 1rem;
}

.wine-popup-card-info {
  flex: 1;
}

.wine-popup-card-name {
  font-family: 'Cinzel', serif;
  font-size: 1.3rem;
  color: var(--gold);
  margin: 0 0 0.5rem 0;
  font-weight: 600;
}

.wine-popup-card-producer {
  font-family: 'Cormorant', serif;
  font-size: 1rem;
  color: var(--muted);
  margin: 0 0 0.75rem 0;
}

.wine-popup-card-details {
  display: flex;
  flex-direction: column;
  gap: 0.25rem;
  font-size: 0.9rem;
  color: var(--muted);
}

.wine-popup-card-vintage,
.wine-popup-card-region {
  font-family: 'Cormorant', serif;
}

.wine-popup-card-price {
  font-family: 'Cinzel', serif;
  font-size: 1.5rem;
  color: var(--gold);
  font-weight: 600;
  white-space: nowrap;
}

.wines-popup-loading,
.wines-popup-empty {
  text-align: center;
  padding: 4rem 2rem;
  color: var(--muted);
}

.wines-popup-loading i {
  font-size: 3rem;
  margin-bottom: 1rem;
  color: var(--gold);
}

.wines-popup-empty i {
  font-size: 3rem;
  margin-bottom: 1rem;
  color: var(--muted);
}

/* Footer */
.footer {
  text-align: center;
  padding: 3rem 2rem;
  margin-top: 4rem;
  border-top: 1px solid rgba(212, 175, 55, 0.2);
  background: rgba(10, 10, 10, 0.95);
}

.footer p {
  color: var(--muted);
  margin-bottom: 1rem;
  font-family: 'Cormorant', serif;
}

/* Responsive */
@media (max-width: 1024px) {
  .process-container {
    flex-direction: column;
    gap: 3rem;
  }
  
  .process-container::before {
    display: none;
  }
  
  .method-column {
    width: 100%;
    max-width: 500px;
  }
  
  /* Tablet styles for wines popup */
  .wines-popup {
    padding: 1.5rem;
  }
  
  .wines-popup-container {
    max-width: 800px;
    max-height: 85vh;
  }
  
  .wines-popup-header {
    padding: 1.75rem;
  }
  
  .wines-popup-title {
    font-size: 1.75rem;
  }
  
  .wines-popup-content {
    padding: 1.75rem;
  }
  
  .wines-popup-list {
    grid-template-columns: repeat(auto-fill, minmax(250px, 1fr));
    gap: 1.25rem;
  }
  
  .wine-popup-card {
    padding: 1.25rem;
  }
  
  .wine-popup-card-name {
    font-size: 1.2rem;
  }
  
  .wine-popup-card-price {
    font-size: 1.4rem;
  }
}

/* Mobile First - Base Styles */
@media (max-width: 768px) {
  html, body {
    overflow-x: hidden;
    width: 100%;
    max-width: 100vw;
    position: relative;
  }
  
  body {
    padding-top: 100px;
  }
  
  .doc-header {
    flex-direction: column;
    gap: 0.75rem;
    padding: 0.75rem 1rem;
  }
  
  .header-nav {
    flex-wrap: wrap;
    justify-content: center;
    gap: 0.5rem;
    width: 100%;
  }
  
  .nav-link {
    font-size: 0.9rem;
    padding: 0.4rem 0.75rem;
    white-space: nowrap;
  }
  
  .btn-back {
    padding: 0.5rem 1rem;
    font-size: 0.9rem;
  }
  
  .hero {
    padding: 2rem 1rem;
  }
  
  .hero h1 {
    font-size: 2rem;
    padding: 0 0.5rem;
  }
  
  .hero-subtitle {
    font-size: 1rem;
    padding: 0 0.5rem;
  }
  
  .method-nav {
    grid-template-columns: 1fr;
    gap: 1rem;
    padding: 0 1rem;
  }
  
  .method-card {
    padding: 1.5rem;
  }
  
  .method-card h3 {
    font-size: 1.4rem;
  }
  
  .method-icon {
    font-size: 2.5rem;
  }
  
  .method-section {
    padding: 2rem 1rem;
  }
  
  .horizontal-process {
    padding: 2rem 1rem;
  }
  
  .process-container {
    padding: 0;
  }
  
  .process-steps {
    width: 100%;
    padding: 0;
  }
  
  .chart-container {
    padding: 1rem;
    margin: 1.5rem 0.5rem;
    max-width: calc(100% - 1rem);
  }
  
  .chart-title {
    font-size: 1.25rem;
    margin-bottom: 1rem;
    padding: 0 0.5rem;
  }
  
  .chart-wrapper {
    height: 250px;
    padding: 0;
  }
  
  .chart-wrapper canvas {
    max-height: 250px !important;
  }
  
  .comparison-table {
    font-size: 0.85rem;
    display: block;
    overflow-x: auto;
    -webkit-overflow-scrolling: touch;
  }
  
  .comparison-table th,
  .comparison-table td {
    padding: 0.75rem 0.5rem;
    font-size: 0.85rem;
    white-space: nowrap;
  }
  
  .method-detail-grid {
    grid-template-columns: 1fr;
    gap: 1rem;
  }
  
  .detail-card {
    padding: 1rem;
  }
  
  .footer {
    padding: 2rem 1rem;
  }
  
  .section-header h2 {
    font-size: 1.75rem;
    padding: 0 0.5rem;
  }
  
  .info-grid {
    grid-template-columns: 1fr;
    gap: 1rem;
    padding: 0 1rem;
  }
  
  .method-view-wines-btn {
    padding: 0.75rem 1.5rem;
    font-size: 1rem;
    width: 100%;
    max-width: 100%;
  }
  
  .method-button-container {
    padding: 0 0.5rem;
  }
  
  .wines-popup {
    padding: 1rem 0.5rem;
  }
  
  .wines-popup-container {
    max-height: 95vh;
  }
  
  .wines-popup-header {
    padding: 1.5rem;
  }
  
  .wines-popup-title {
    font-size: 1.5rem;
  }
  
  .wines-popup-content {
    padding: 1.5rem;
  }
  
  .wines-popup-list {
    grid-template-columns: 1fr;
    gap: 1rem;
  }
  
  .wine-popup-card {
    padding: 1rem;
  }
  
  .wine-popup-card-name {
    font-size: 1.1rem;
  }
  
  .wine-popup-card-price {
    font-size: 1.3rem;
  }
}

/* Extra Small Devices */
@media (max-width: 480px) {
  .hero h1 {
    font-size: 1.75rem;
  }
  
  .method-card h3 {
    font-size: 1.2rem;
  }
  
  .chart-title {
    font-size: 1.1rem;
  }
  
  .nav-link {
    font-size: 0.8rem;
    padding: 0.35rem 0.6rem;
  }
  
  .section-header h2 {
    font-size: 1.5rem;
  }
}
</style>
</head>
<body>
<div class="main-container">

<!-- Navigation Header -->
<header class="doc-header">
  <div class="header-brand">
    <a href="./wine-map.html" class="btn-back">
      <i class="fas fa-arrow-left"></i>
      Back to Wine Map
    </a>
  </div>
  
  <nav class="header-nav">
    <a href="#methods" class="nav-link active">Methods</a>
    <a href="#comparison" class="nav-link">Comparison</a>
    <a href="#tasting" class="nav-link">Tasting</a>
    <a href="#regulations" class="nav-link">Regulations</a>
    <a href="#production" class="nav-link">Production</a>
  </nav>
</header>

<!-- Hero Section -->
<section class="hero" id="methods">
  <h1>Technical Guide to Italian Sparkling Wines</h1>
  <p class="hero-subtitle">Complete analysis of production methods, technical differences, organoleptic characteristics and classifications according to Italian and European regulations</p>
</section>

<!-- Navigation Cards -->
<div class="method-nav">
  <div class="method-card charmat" onclick="scrollToSection('charmat-section')">
    <div class="method-icon">
      <i class="fas fa-industry"></i>
    </div>
    <h3>Martinotti-Charmat Method</h3>
    <p>Second fermentation in autoclave - Prosecco, modern Lambrusco</p>
    </div>
  
  <div class="method-card ancestrale" onclick="scrollToSection('ancestrale-section')">
    <div class="method-icon">
      <i class="fas fa-wine-bottle"></i>
    </div>
    <h3>Ancestral/Rural Method</h3>
    <p>Single fermentation in bottle - Pet Nat, "col fondo" wines</p>
    </div>
  
  <div class="method-card classico" onclick="scrollToSection('classico-section')">
    <div class="method-icon">
      <i class="fas fa-gem"></i>
  </div>
    <h3>Classic Method (Traditional)</h3>
    <p>Second fermentation in bottle - Franciacorta, Trento DOC</p>
  </div>
</div>

<!-- HORIZONTAL Production Process Comparison -->
<section id="production" class="horizontal-process">
  <div class="section-header">
    <h2>Production Process Comparison</h2>
    <p style="color: var(--muted); max-width: 800px; margin: 0 auto; padding: 0 1rem; width: 100%; box-sizing: border-box;">Visual comparison of the three main production methods used for Italian sparkling wines</p>
  </div>
  
  <div class="process-container">
    <!-- Charmat Method Column -->
    <div class="method-column">
      <div class="method-title" style="border: 2px solid var(--charmat);">
        Charmat Method
      </div>
      <div class="process-steps charmat-steps">
      <div class="process-step">
          <span class="step-number">1</span>
          Base Wine Preparation
      </div>
      <div class="process-step">
          <span class="step-number">2</span>
          Autoclave Fermentation
      </div>
      <div class="process-step">
          <span class="step-number">3</span>
          Pressure Stabilization
      </div>
      <div class="process-step">
          <span class="step-number">4</span>
          Isobaric Bottling
      </div>
    </div>
  </div>
  
    <!-- Ancestral Method Column -->
    <div class="method-column">
      <div class="method-title" style="border: 2px solid var(--ancestrale);">
        Ancestral Method
      </div>
      <div class="process-steps ancestrale-steps">
      <div class="process-step">
          <span class="step-number">1</span>
          Partial Fermentation
      </div>
      <div class="process-step">
          <span class="step-number">2</span>
          Early Bottling
      </div>
      <div class="process-step">
          <span class="step-number">3</span>
          Natural Bottle Fermentation
      </div>
      <div class="process-step">
          <span class="step-number">4</span>
          No Disgorgement (Lees Present)
      </div>
    </div>
  </div>
  
    <!-- Classic Method Column -->
    <div class="method-column">
      <div class="method-title" style="border: 2px solid var(--classico);">
        Classic Method
      </div>
      <div class="process-steps classico-steps">
      <div class="process-step">
          <span class="step-number">1</span>
          Base Wine + Liqueur de Tirage
      </div>
      <div class="process-step">
          <span class="step-number">2</span>
          Bottle Fermentation
      </div>
      <div class="process-step">
          <span class="step-number">3</span>
          Aging on Lees (18-36+ months)
      </div>
      <div class="process-step">
          <span class="step-number">4</span>
          Riddling & Disgorgement
      </div>
    </div>
    </div>
  </div>
</section>

<!-- Pressure Chart -->
<section id="comparison" class="chart-container">
  <h2 class="chart-title">Pressure Classification (EU Regulation)</h2>
  <div class="chart-wrapper">
    <canvas id="pressureChart"></canvas>
  </div>
</section>

<!-- Sweetness Scale -->
<section class="chart-container">
  <h2 class="chart-title">Sweetness Scale - Residual Sugars</h2>
  <div class="chart-wrapper">
    <canvas id="sweetnessChart"></canvas>
    </div>
</section>

<!-- Comparison Table -->
<section class="chart-container">
  <h2 class="chart-title">Detailed Technical Comparison</h2>
  <table class="comparison-table">
    <thead>
      <tr>
        <th>Characteristic</th>
        <th>Charmat</th>
        <th>Ancestral</th>
        <th>Classic</th>
      </tr>
    </thead>
    <tbody>
      <tr>
        <td><strong>Production time</strong></td>
        <td>2-3 months</td>
        <td>6-12 months</td>
        <td>18-36+ months</td>
      </tr>
      <tr>
        <td><strong>Pressure (atm)</strong></td>
        <td>3-5</td>
        <td>2-6</td>
        <td>5-6</td>
      </tr>
      <tr>
        <td><strong>Fermentation temperature</strong></td>
        <td>14-18°C</td>
        <td>Ambient</td>
        <td>10-12°C</td>
      </tr>
      <tr>
        <td><strong>Primary aroma intensity</strong></td>
        <td>High</td>
        <td>Medium</td>
        <td>Low</td>
      </tr>
      <tr>
        <td><strong>Tertiary aroma complexity</strong></td>
        <td>Low</td>
        <td>Medium</td>
        <td>High</td>
      </tr>
      <tr>
        <td><strong>Aging potential</strong></td>
        <td>1-3 years</td>
        <td>2-5 years</td>
        <td>5-10+ years</td>
      </tr>
      <tr>
        <td><strong>Production cost</strong></td>
        <td>Low-Medium</td>
        <td>Medium</td>
        <td>High</td>
      </tr>
      <tr>
        <td><strong>Bubble characteristics</strong></td>
        <td>Medium, short persistence</td>
        <td>Irregular, lively</td>
        <td>Fine, persistent</td>
      </tr>
    </tbody>
  </table>
</section>

<!-- Charmat Method Section -->
<section id="charmat-section" class="method-section charmat">
  <div class="section-header">
    <h2>Martinotti-Charmat Method</h2>
    <p style="color: var(--muted); max-width: 800px; margin: 0 auto; padding: 0 1rem; width: 100%; box-sizing: border-box;">Also known as the "autoclave method" or "tank method" - Modern and efficient production</p>
    </div>
  
  <div class="method-detail-grid">
    <div class="detail-card charmat">
      <h4><i class="fas fa-cogs"></i> Technical Process</h4>
      <p>Second fermentation occurs in pressurized stainless steel tanks (autoclaves) under controlled temperature (14-18°C) for 10-60 days.</p>
  </div>
  
    <div class="detail-card charmat">
      <h4><i class="fas fa-wine-glass-alt"></i> Organoleptic Profile</h4>
      <p>Preserves primary aromas of fresh fruit and flowers. Immediate freshness with clean finish. Medium bubbles with limited persistence.</p>
    </div>
  
    <div class="detail-card charmat">
      <h4><i class="fas fa-map-marker-alt"></i> Typical Wines</h4>
      <p>Prosecco DOC/DOCG, modern Lambrusco, some aromatic sparkling wines, Asti Spumante (with variations).</p>
    </div>
  </div>
  <div class="method-button-container">
    <a href="#" class="method-view-wines-btn charmat" data-method="METODO MARTINOTTI" data-method-name="Charmat Method">
      <i class="fas fa-wine-glass"></i>
      View Wines with Charmat Method
    </a>
  </div>
</section>

<!-- Ancestral Method Section -->
<section id="ancestrale-section" class="method-section ancestrale">
  <div class="section-header">
    <h2>Ancestral/Rural Method</h2>
    <p style="color: var(--muted); max-width: 800px; margin: 0 auto; padding: 0 1rem; width: 100%; box-sizing: border-box;">The oldest sparkling wine production method - Natural and artisanal approach</p>
    </div>
  
  <div class="method-detail-grid">
    <div class="detail-card ancestrale">
      <h4><i class="fas fa-history"></i> Technical Process</h4>
      <p>Single fermentation that begins in tank and completes in bottle without disgorgement. Natural sediment (lees) remains in bottle.</p>
    </div>
    
    <div class="detail-card ancestrale">
      <h4><i class="fas fa-wine-glass-alt"></i> Organoleptic Profile</h4>
      <p>Earthy notes, wild yeast character, ripe fruit aromas. Rustic structure with complex finish. Irregular, lively bubbles.</p>
  </div>
  
    <div class="detail-card ancestrale">
      <h4><i class="fas fa-map-marker-alt"></i> Typical Wines</h4>
      <p>Pétillant Naturel (Pet Nat), traditional "col fondo" wines, some natural sparkling wines, ancestral method Lambrusco.</p>
      </div>
  </div>
  <div class="method-button-container">
    <a href="#" class="method-view-wines-btn ancestrale" data-method="METODO ANCESTRALE" data-method-name="Ancestral Method">
      <i class="fas fa-wine-glass"></i>
      View Wines with Ancestral Method
    </a>
  </div>
</section>

<!-- Classic Method Section -->
<section id="classico-section" class="method-section classico">
  <div class="section-header">
    <h2>Classic Method (Traditional)</h2>
    <p style="color: var(--muted); max-width: 800px; margin: 0 auto; padding: 0 1rem; width: 100%; box-sizing: border-box;">Also known as "Méthode Champenoise" - The most prestigious and complex method</p>
  </div>
  
  <div class="method-detail-grid">
    <div class="detail-card classico">
      <h4><i class="fas fa-crown"></i> Technical Process</h4>
      <p>Second fermentation in bottle with minimum 18 months aging on lees. Manual or mechanical riddling followed by disgorgement.</p>
    </div>
    
    <div class="detail-card classico">
      <h4><i class="fas fa-wine-glass-alt"></i> Organoleptic Profile</h4>
      <p>Tertiary aromas (yeast, toasted bread, dried fruit). Complex structure with long persistence. Fine, persistent bubbles.</p>
      </div>
    
    <div class="detail-card classico">
      <h4><i class="fas fa-map-marker-alt"></i> Typical Wines</h4>
      <p>Franciacorta DOCG, Trento DOC, Oltrepò Pavese Metodo Classico, some Alta Langa and sparkling wines from Etna.</p>
      </div>
      </div>
  <div class="method-button-container">
    <a href="#" class="method-view-wines-btn classico" data-method="METODO CLASSICO" data-method-name="Classic Method">
      <i class="fas fa-wine-glass"></i>
      View Wines with Classic Method
    </a>
  </div>
</section>

<!-- Tasting Info -->
<section id="tasting" class="info-grid">
  <div class="info-card">
    <h4>Tasting - Charmat Method</h4>
    <p><strong>Bubbles:</strong> Medium, limited persistence</p>
    <p><strong>Nose:</strong> Fresh fruit, flowers</p>
    <p><strong>Palate:</strong> Immediate freshness</p>
    <p><strong>Serving temperature:</strong> 6-8°C</p>
    <p><strong>Food pairings:</strong> Appetizers, raw fish, aperitif</p>
      </div>
  
  <div class="info-card">
    <h4>Tasting - Ancestral Method</h4>
    <p><strong>Bubbles:</strong> Irregular, lively effervescence</p>
    <p><strong>Nose:</strong> Earthy notes, wild yeasts</p>
    <p><strong>Palate:</strong> Rustic structure</p>
    <p><strong>Serving temperature:</strong> 8-10°C</p>
    <p><strong>Food pairings:</strong> Charcuterie, aged cheeses</p>
    </div>
    
  <div class="info-card">
    <h4>Tasting - Classic Method</h4>
    <p><strong>Bubbles:</strong> Fine, persistent</p>
    <p><strong>Nose:</strong> Yeast, toasted bread</p>
    <p><strong>Palate:</strong> Complex structure</p>
    <p><strong>Serving temperature:</strong> 8-10°C</p>
    <p><strong>Food pairings:</strong> Structured dishes, shellfish</p>
  </div>
</section>

<!-- Regulation Info -->
<section id="regulations" class="chart-container">
  <h2 class="chart-title">Regulations and Classification</h2>
  <div class="info-grid" style="display: grid; grid-template-columns: repeat(auto-fit, minmax(280px, 1fr)); gap: 1.5rem; width: 100%; max-width: 100%;">
    <div class="info-card">
      <h4>DOCG / DOC</h4>
      <p>Denominazione di Origine Controllata e Garantita</p>
      <p><strong>Examples:</strong> Franciacorta DOCG, Prosecco DOC</p>
    </div>
    
    <div class="info-card">
      <h4>IGT</h4>
      <p>Indicazione Geografica Tipica</p>
      <p><strong>Examples:</strong> Sparkling wines IGT Veneto</p>
    </div>
    
    <div class="info-card">
      <h4>Classic Method Requirements</h4>
      <p>Second fermentation in bottle ≥ 18 months aging</p>
      <p><strong>Examples:</strong> Franciacorta, Trento DOC</p>
    </div>
  </div>
</section>

<footer class="footer">
  <p><strong>Final note:</strong> The choice of production method expresses a precise oenological philosophy, from Charmat (modernity) to Ancestral (tradition) to Classic (craftsmanship and complexity).</p>
  <p>© Technical Guide Gran Caffè L'Aquila</p>
</footer>

<script>
// Pressure Chart
const pressureCtx = document.getElementById('pressureChart').getContext('2d');
const pressureChart = new Chart(pressureCtx, {
  type: 'bar',
  data: {
    labels: ['Still Wine', 'Frizzante', 'Sparkling'],
    datasets: [{
      label: 'Pressure (atm)',
      data: [0.5, 1.75, 4],
      backgroundColor: [
        'rgba(122, 31, 43, 0.7)',
        'rgba(237, 108, 2, 0.7)',
        'rgba(212, 175, 55, 0.7)'
      ],
      borderColor: [
        'rgba(122, 31, 43, 1)',
        'rgba(237, 108, 2, 1)',
        'rgba(212, 175, 55, 1)'
      ],
      borderWidth: 2
    }]
  },
  options: {
    responsive: true,
    maintainAspectRatio: false,
    scales: {
      y: {
        beginAtZero: true,
        title: {
          display: true,
          text: 'Atmospheres (atm)',
          color: '#F5F5F0',
          font: {
            family: 'Cormorant',
            size: 14,
            weight: 500
          }
        },
        ticks: { 
          color: '#F5F5F0',
          font: {
            family: 'Cormorant',
            size: 12
          }
        },
        grid: { 
          color: 'rgba(245, 245, 240, 0.1)',
          lineWidth: 1
        }
      },
      x: {
        ticks: { 
          color: '#F5F5F0',
          font: {
            family: 'Cormorant',
            size: 12
          }
        },
        grid: { 
          color: 'rgba(245, 245, 240, 0.1)',
          lineWidth: 1
        }
      }
    },
    plugins: {
      legend: {
        labels: { 
          color: '#F5F5F0',
          font: {
            family: 'Cormorant',
            size: 13
          },
          padding: 15
        }
      },
      tooltip: {
        backgroundColor: 'rgba(26, 26, 26, 0.95)',
        titleColor: '#D4AF37',
        bodyColor: '#F5F5F0',
        borderColor: 'rgba(212, 175, 55, 0.3)',
        borderWidth: 1,
        padding: 12,
        titleFont: {
          family: 'Cinzel',
          size: 14,
          weight: 600
        },
        bodyFont: {
          family: 'Cormorant',
          size: 13
        }
      }
    }
  }
});

// Sweetness Chart
const sweetnessCtx = document.getElementById('sweetnessChart').getContext('2d');
const sweetnessChart = new Chart(sweetnessCtx, {
  type: 'line',
  data: {
    labels: ['Brut Nature', 'Extra Brut', 'Brut', 'Extra Dry', 'Dry', 'Demi-Sec', 'Doux'],
    datasets: [{
      label: 'Residual Sugar (g/L)',
      data: [1.5, 3, 6, 14.5, 24.5, 41, 60],
      borderColor: 'rgba(212, 175, 55, 1)',
      backgroundColor: 'rgba(212, 175, 55, 0.1)',
      borderWidth: 3,
      fill: true,
      tension: 0.4
    }]
  },
  options: {
    responsive: true,
    maintainAspectRatio: false,
    scales: {
      y: {
        beginAtZero: true,
        title: {
          display: true,
          text: 'Grams per liter (g/L)',
          color: '#F5F5F0',
          font: {
            family: 'Cormorant',
            size: 14,
            weight: 500
          }
        },
        ticks: { 
          color: '#F5F5F0',
          font: {
            family: 'Cormorant',
            size: 12
          }
        },
        grid: { 
          color: 'rgba(245, 245, 240, 0.1)',
          lineWidth: 1
        }
      },
      x: {
        ticks: { 
          color: '#F5F5F0',
          font: {
            family: 'Cormorant',
            size: 11
          },
          maxRotation: 45,
          minRotation: 0
        },
        grid: { 
          color: 'rgba(245, 245, 240, 0.1)',
          lineWidth: 1
        }
      }
    },
    plugins: {
      legend: {
        labels: { 
          color: '#F5F5F0',
          font: {
            family: 'Cormorant',
            size: 13
          },
          padding: 15
        }
      },
      tooltip: {
        backgroundColor: 'rgba(26, 26, 26, 0.95)',
        titleColor: '#D4AF37',
        bodyColor: '#F5F5F0',
        borderColor: 'rgba(212, 175, 55, 0.3)',
        borderWidth: 1,
        padding: 12,
        titleFont: {
          family: 'Cinzel',
          size: 14,
          weight: 600
        },
        bodyFont: {
          family: 'Cormorant',
          size: 13
        }
      }
    }
  }
});

// Navigation Functions
function scrollToSection(sectionId) {
  const section = document.getElementById(sectionId);
  if (section) {
    // Calculate offset for fixed header
    const headerHeight = document.querySelector('.doc-header')?.offsetHeight || 70;
    const elementPosition = section.getBoundingClientRect().top;
    const offsetPosition = elementPosition + window.pageYOffset - headerHeight;
    
    window.scrollTo({
      top: offsetPosition,
      behavior: 'smooth'
    });
    
    // Highlight active navigation
    document.querySelectorAll('.nav-link').forEach(l => l.classList.remove('active'));
    
    // Map section IDs to navigation links
    const navMap = {
      'charmat-section': 'methods',
      'ancestrale-section': 'methods', 
      'classico-section': 'methods',
      'production': 'production',
      'comparison': 'comparison',
      'tasting': 'tasting',
      'regulations': 'regulations'
    };
    
    const navId = navMap[sectionId];
    if (navId) {
      const navLink = document.querySelector(`.nav-link[href="#${navId}"]`);
      if (navLink) navLink.classList.add('active');
    }
  }
}

// Highlight active navigation
document.querySelectorAll('.nav-link').forEach(link => {
  link.addEventListener('click', function(e) {
    e.preventDefault();
    const targetId = this.getAttribute('href').substring(1);
    const targetSection = document.getElementById(targetId);
    
    if (targetSection) {
      // Calculate offset for fixed header
      const headerHeight = document.querySelector('.doc-header')?.offsetHeight || 70;
      const elementPosition = targetSection.getBoundingClientRect().top;
      const offsetPosition = elementPosition + window.pageYOffset - headerHeight;
      
      window.scrollTo({
        top: offsetPosition,
        behavior: 'smooth'
      });
      
      document.querySelectorAll('.nav-link').forEach(l => l.classList.remove('active'));
      this.classList.add('active');
    } else if (targetId === 'methods') {
      // If methods section not found, scroll to top
      window.scrollTo({
        top: 0,
        behavior: 'smooth'
      });
      
      document.querySelectorAll('.nav-link').forEach(l => l.classList.remove('active'));
      this.classList.add('active');
    }
  });
});

// Animate process steps on scroll
const observerOptions = {
  threshold: 0.2,
  rootMargin: '0px 0px -50px 0px'
};

const observer = new IntersectionObserver((entries) => {
  entries.forEach(entry => {
    if (entry.isIntersecting) {
      const steps = entry.target.querySelectorAll('.process-step');
      steps.forEach((step, index) => {
        setTimeout(() => {
          step.style.opacity = '1';
          step.style.transform = 'translateY(0)';
        }, index * 200);
      });
    }
  });
}, observerOptions);

// Observe process sections
document.querySelectorAll('.process-steps').forEach(steps => {
  steps.querySelectorAll('.process-step').forEach(step => {
    step.style.opacity = '0';
    step.style.transform = 'translateY(20px)';
    step.style.transition = 'opacity 0.5s ease, transform 0.5s ease';
  });
  observer.observe(steps);
});

// Add hover effects to method cards
document.querySelectorAll('.method-card').forEach(card => {
  card.addEventListener('mouseenter', function() {
    const icon = this.querySelector('.method-icon i');
    icon.style.transform = 'scale(1.2)';
    icon.style.transition = 'transform 0.3s ease';
  });
  
  card.addEventListener('mouseleave', function() {
    const icon = this.querySelector('.method-icon i');
    icon.style.transform = 'scale(1)';
  });
});

// ==================== WINES POPUP ====================
// Popup Modal for displaying wines by method
let winesPopup;
let winesPopupContent;
let winesPopupTitle;
let winesPopupList;
let winesPopupClose;
let allWines = [];

// Initialize popup elements
function initPopupElements() {
  winesPopup = document.getElementById('winesPopup');
  winesPopupContent = document.getElementById('winesPopupContent');
  winesPopupTitle = document.getElementById('winesPopupTitle');
  winesPopupList = document.getElementById('winesPopupList');
  winesPopupClose = document.getElementById('winesPopupClose');
}

// Load wines data
async function loadWinesData() {
  try {
    const response = await fetch('./data/wines.json');
    const data = await response.json();
    allWines = data.wines || [];
    console.log(`Loaded ${allWines.length} wines`);
  } catch (error) {
    console.error('Error loading wines:', error);
    allWines = [];
  }
}

// Open popup with filtered wines
function openWinesPopup(subcategory, methodName) {
  if (allWines.length === 0) {
    loadWinesData().then(() => {
      showWinesInPopup(subcategory, methodName);
    });
  } else {
    showWinesInPopup(subcategory, methodName);
  }
}

function showWinesInPopup(subcategory, methodName) {
  // Ensure elements are initialized
  if (!winesPopup || !winesPopupTitle || !winesPopupList) {
    initPopupElements();
  }
  
  // Check if elements exist
  if (!winesPopup || !winesPopupTitle || !winesPopupList) {
    console.error('Popup elements not found');
    return;
  }
  
  // Filter wines by subcategory and type BOLLICINE
  const filteredWines = allWines.filter(wine => {
    const matchesSubcategory = wine.subcategory && 
      wine.subcategory.toUpperCase() === subcategory.toUpperCase();
    const matchesType = wine.wine_type && 
      wine.wine_type.toUpperCase().includes('BOLLICINE');
    return matchesSubcategory && matchesType;
  });

  // Set title
  winesPopupTitle.textContent = `Wines with ${methodName}`;
  
  // Clear previous content
  winesPopupList.innerHTML = '';
  
  if (filteredWines.length === 0) {
    winesPopupList.innerHTML = `
      <div class="wines-popup-empty">
        <i class="fas fa-wine-glass" style="font-size: 3rem; color: var(--muted); margin-bottom: 1rem;"></i>
        <p>No wines found for this method.</p>
      </div>
    `;
  } else {
    filteredWines.forEach(wine => {
      const wineCard = createWineCard(wine);
      winesPopupList.appendChild(wineCard);
    });
  }
  
  // Show popup
  winesPopup.style.display = 'flex';
  document.body.style.overflow = 'hidden';
}

function createWineCard(wine) {
  const card = document.createElement('div');
  card.className = 'wine-popup-card';
  card.dataset.wineId = wine.wine_number;
  
  const price = wine.wine_price || wine.wine_price_bottle || wine.wine_price_glass || 'N/A';
  const producer = wine.wine_producer || 'Unknown Producer';
  const vintage = wine.wine_vintage || 'N/A';
  const region = wine.region || 'N/A';
  
  card.innerHTML = `
    <div class="wine-popup-card-content">
      <div class="wine-popup-card-info">
        <h4 class="wine-popup-card-name">${wine.wine_name || 'Unknown Wine'}</h4>
        <p class="wine-popup-card-producer">${producer}</p>
        <div class="wine-popup-card-details">
          <span class="wine-popup-card-vintage">${vintage !== 'N/A' ? vintage : ''}</span>
          ${region !== 'N/A' ? `<span class="wine-popup-card-region">${region}</span>` : ''}
        </div>
      </div>
      <div class="wine-popup-card-price">$${price}</div>
    </div>
  `;
  
  // Add click event to navigate to wine details
  card.addEventListener('click', () => {
    window.location.href = `wine-details.html?id=${wine.wine_number}`;
  });
  
  return card;
}

// Close popup
function closeWinesPopup() {
  if (!winesPopup) {
    initPopupElements();
  }
  if (winesPopup) {
    winesPopup.style.display = 'none';
    document.body.style.overflow = '';
  }
}

// Setup event listeners
function setupPopupEventListeners() {
  if (!winesPopupClose) {
    initPopupElements();
  }
  
  if (winesPopupClose) {
    winesPopupClose.addEventListener('click', closeWinesPopup);
  }

  // Close on background click
  if (winesPopup) {
    winesPopup.addEventListener('click', (e) => {
      if (e.target === winesPopup) {
        closeWinesPopup();
      }
    });
  }
}

// Close on ESC key
document.addEventListener('keydown', (e) => {
  if (e.key === 'Escape') {
    if (!winesPopup) {
      initPopupElements();
    }
    if (winesPopup && winesPopup.style.display === 'flex') {
      closeWinesPopup();
    }
  }
});

// Update button links to open popup
document.addEventListener('DOMContentLoaded', () => {
  // Initialize popup elements
  initPopupElements();
  
  // Setup event listeners
  setupPopupEventListeners();
  
  // Add event listeners to all method buttons
  document.querySelectorAll('.method-view-wines-btn').forEach(btn => {
    btn.addEventListener('click', (e) => {
      e.preventDefault();
      const method = btn.getAttribute('data-method');
      const methodName = btn.getAttribute('data-method-name');
      if (method && methodName) {
        openWinesPopup(method, methodName);
      }
    });
  });
  
  // Load wines data on page load
  loadWinesData();
});
</script>
</div>

<!-- Wines Popup Modal -->
<div id="winesPopup" class="wines-popup">
  <div class="wines-popup-container">
    <div class="wines-popup-header">
      <h2 id="winesPopupTitle" class="wines-popup-title">Wines</h2>
      <button id="winesPopupClose" class="wines-popup-close" aria-label="Close">
        <i class="fas fa-times"></i>
      </button>
    </div>
    <div id="winesPopupContent" class="wines-popup-content">
      <div id="winesPopupList" class="wines-popup-list">
        <div class="wines-popup-loading">
          <i class="fas fa-spinner fa-spin"></i>
          <p>Loading wines...</p>
        </div>
      </div>
    </div>
  </div>
</div>

</body>
</html>